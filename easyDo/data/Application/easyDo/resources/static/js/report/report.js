function initReport(t){showLoading();var e=parent.$(".slimScrollDiv").height();e||(e=parent.parent.$(".slimScrollDiv").height()),e-=70,$(".table-list-box .search-condition").length&&(e-=60),parent.$(".signType").length&&(e-=40,$(".change-tab").length&&(e-=50)),$(".reportChartBox, .report-select").css("height",e+"px").show(),$(".report-type-list").css("height",e-40+"px"),$("#grid-table").closest(".table-wrap").hide(),$('.t-btn[signBtn="common"]').hide(),$('.t-btn[signBtn="print"]').show(),$(".tree-box").length&&($(".wrapper-content").removeClass("tree"),$(".list-box").addClass("col-sm-12").removeClass("col-sm-11").css("width","100%"),$(".tree-box").hide()),changeReportSelectTop(),$(".report-select li").unbind("click").click((function(){$(".report-select li").removeClass("curType"),$(this).addClass("curType"),loadReportChart($(this).attr("id"))})),loadReportChart($(".report-select li.curType").attr("id"))}function changeReportSelectTop(){if(parent.$(".title-ul").length){var t=0;t=$(".change-tab").length?91:43,parent.$(".signType").length&&($(".search-condition").length?t+=73:t+=13),$(".report-select").css({top:t+"px",right:"-10px"})}else $(".table-list-box .search-condition").length?$(".report-select").css({top:"113px"}):$(".report-select").css({top:"53px"})}function loadReportChart(reportId){var belongType=$("#belongType").val(),belongId=$("#belongId").val(),projectId="";belongType&&"PJT"==belongType&&(projectId=belongId),$.ajax({cache:!0,type:"POST",url:"/report/getChartData",data:{reportId:reportId,viewId:$("#viewId").val(),filterConditions:getNewFilterConditions(),projectId:projectId,queryObject:$("#queryObject").val(),dateType:$("#dateType").val()},async:!1,success:function(data){var $reportChart=$("#reportChart");if(data){data=eval("("+data+")"),$reportChart.html()&&$reportChart.initEcharts("destroy"),$reportChart.initEcharts({title:data.title,type:data.type,data:data.chartData,theme:$reportChart.closest("body").hasClass("theme-dark")?"dark":""});var detailData=data.detailData;initChartDetail(detailData,data.chartData)}else $reportChart.initEcharts();hideLoading()}})}function initChartDetail(t,e,a,r){if(t){for(var i="",l="",o="",n="",s=0;s<t.length;s++){l=t[s],o='<div class="chart-row '+(s%2==0?"even":"")+'">';for(var c=0;c<l.length;c++)n=s>0&&c>0?"clink":"",c==l.length-1&&(l[c].groupByName=""),s==t.length-1&&(l[c].classByName=""),o+='<div class="'+l[c].className+" "+n+'" title="'+l[c].value+'" dataId="'+l[c].id+'" classByName="'+(l[c].classByName?l[c].classByName:"")+'" groupByName="'+(l[c].groupByName?l[c].groupByName:"")+'">'+l[c].value+"</div>";i+=o+="</div>"}a&&a.length?a.html(i):$(".chart-content").html(i)}$(".clink").unbind("click").click((function(){var t=$(this),e="",a=$(this).attr("classByName"),i="",l=$(this).attr("groupByName");if(a){var o=t.closest(".chart-row").find(".chart-td:first");(e=o.attr("dataId"))&&"DATE"==e&&(e=o.attr("title"))}if(l){var n=t.index(),s=$(".chart-row").find(".chart-th").eq(n);(i=s.attr("dataId"))&&"DATE"==i&&(i=s.attr("title"))}intoEchartDataList(e,a,i,l,r)}))}function printReport(){$("#reportDetail").jqprint()}