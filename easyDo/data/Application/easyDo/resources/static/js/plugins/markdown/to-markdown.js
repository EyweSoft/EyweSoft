var toMarkdown=function(e){for(var n=[{patterns:"p",replacement:function(e,n,t){return t?"\n\n"+t+"\n":""}},{patterns:"br",type:"void",replacement:"\n"},{patterns:"h([1-6])",replacement:function(e,n,t,r){for(var a="",c=0;c<n;c++)a+="#";return"\n\n"+a+" "+r+"\n"}},{patterns:"hr",type:"void",replacement:"\n\n* * *\n"},{patterns:"a",replacement:function(e,n,t){var r=n.match(l("href")),a=n.match(l("title"));return r?"["+t+"]("+r[1]+(a&&a[1]?' "'+a[1]+'"':"")+")":e}},{patterns:["b","strong"],replacement:function(e,n,t){return t?"**"+t+"**":""}},{patterns:["i","em"],replacement:function(e,n,t){return t?"_"+t+"_":""}},{patterns:"code",replacement:function(e,n,t){return t?"`"+t+"`":""}},{patterns:"img",type:"void",replacement:function(e,n,t){var r=n.match(l("src")),a=n.match(l("alt")),c=n.match(l("title"));return"!["+(a&&a[1]?a[1]:"")+"]("+r[1]+(c&&c[1]?' "'+c[1]+'"':"")+")"}}],t=0,r=n.length;t<r;t++)if("string"==typeof n[t].patterns)e=p(e,{tag:n[t].patterns,replacement:n[t].replacement,type:n[t].type});else for(var a=0,c=n[t].patterns.length;a<c;a++)e=p(e,{tag:n[t].patterns[a],replacement:n[t].replacement,type:n[t].type});function p(e,n){var t="void"===n.type?"<"+n.tag+"\\b([^>]*)\\/?>":"<"+n.tag+"\\b([^>]*)>([\\s\\S]*?)<\\/"+n.tag+">",r=new RegExp(t,"gi");return"string"==typeof n.replacement?e.replace(r,n.replacement):e.replace(r,(function(e,t,r,a){return n.replacement.call(this,e,t,r,a)}))}function l(e){return new RegExp(e+"\\s*=\\s*[\"']?([^\"']*)[\"']?","i")}e=(e=e.replace(/<pre\b[^>]*>`([\s\S]*)`<\/pre>/gi,(function(e,n){return"\n\n    "+(n=(n=n.replace(/^\t+/g,"  ")).replace(/\n/g,"\n    "))+"\n"}))).replace(/^(\s{0,3}\d+)\. /g,"$1\\. ");for(var o=/<(ul|ol)\b[^>]*>(?:(?!<ul|<ol)[\s\S])*?<\/\1>/gi;e.match(o);)e=e.replace(o,(function(e){return u(e)}));function u(e){return"\n\n"+(e=e.replace(/<(ul|ol)\b[^>]*>([\s\S]*?)<\/\1>/gi,(function(e,n,a){var c=a.split("</li>");for(c.splice(c.length-1,1),t=0,r=c.length;t<r;t++)if(c[t]){var p="ol"===n?t+1+".  ":"*   ";c[t]=c[t].replace(/\s*<li[^>]*>([\s\S]*)/i,(function(e,n){return n=(n=(n=n.replace(/^\s+/,"")).replace(/\n\n/g,"\n\n    ")).replace(/\n([ ]*)+(\*|\d+\.) /g,"\n$1    $2 "),p+n}))}return c.join("\n")}))).replace(/[ \t]+\n|\s+$/g,"")}for(var i=/<blockquote\b[^>]*>((?:(?!<blockquote)[\s\S])*?)<\/blockquote>/gi;e.match(i);)e=e.replace(i,(function(e){return s(e)}));function s(e){return e=e.replace(/<blockquote\b[^>]*>([\s\S]*?)<\/blockquote>/gi,(function(e,n){return n=(n=(n=g(n=n.replace(/^\s+|\s+$/g,""))).replace(/^/gm,"> ")).replace(/^(>([ \t]{2,}>)+)/gm,"> >")}))}function g(e){return e=(e=(e=e.replace(/^[\t\r\n]+|[\t\r\n]+$/g,"")).replace(/\n\s+\n/g,"\n\n")).replace(/\n{3,}/g,"\n\n")}return g(e)};"object"==typeof exports&&(exports.toMarkdown=toMarkdown);