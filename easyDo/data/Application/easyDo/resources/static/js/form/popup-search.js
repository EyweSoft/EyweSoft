function loadTree(e,t){$("#deptTree").jstree({core:{data:e,multiple:t},plugins:[t?"checkbox":""],checkbox:{three_state:t}}).on("ready.jstree",(function(e,d){selectIds?(checkOrUnCheckTreeNode($("#deptTree"),t,!0,selectIds),$(".selected-ul li").each((function(){selectIds.indexOf($(this).attr("attrId"))<0&&deleteOne($(this))}))):$(".selected-ul li").each((function(){checkOrUnCheckTreeNode($("#deptTree"),t,!0,$(this).attr("attrId"))}))})),$("#deptTree").jstree().open_all(),hideLoading()}function deleteOne(e){checkOrUnCheckTreeNode($("#deptTree"),isMul,!1,e.attr("attrId")),e.remove(),$(".dataList").find('li[id="'+e.attr("attrId")+'"]').removeClass("selected"),$(".deptTree").find('li[id="'+e.attr("attrId")+'"]').removeClass("selected")}function deleteAll(e){checkOrUnCheckTreeNode($("#deptTree"),isMul,!1),e.closest(".selected-list").next("ul").children().remove(),$(".dataList").find(".dataLi").removeClass("selected"),$(".deptTree").find(".dataLi").removeClass("selected")}function checkOrUnCheckTreeNode(e,t,d,l){e.length&&(t?d?l?e.jstree("check_node",l.split(",")):e.jstree("check_all"):l?e.jstree("uncheck_node",l.split(",")):e.jstree("uncheck_all"):(e.jstree("deselect_all"),d&&e.jstree("select_node",l)))}function loadDefaultCheckedOptions(e){if("LIST"!=e||$(".dataList").find("li").length){var t,d=$(".dataList"),l=$(".selected-ul li");e&&"LIST"==e&&d.find(".selected").removeClass("selected"),l.each((function(){t=$(this).attr("attrId"),e&&"LIST"==e?d.find('li[id="'+t+'"]').addClass("selected"):checkOrUnCheckTreeNode($("#deptTree"),isMul,!0,t)}))}else getDataList()}function selectNode(e,t,d,l){var n=$(".box-right ul"),a=$(".dataList").length>0||$("#noCheckedParent").length;if(t){var r,i="",s=e.children_d,c=!0;if("-1"!=e.id&&(r=e.state.mType,c=e.state.opened,n.find('li[attrId="'+e.id+'"]').length||(!a||r&&"dept"==r)&&a||(i+=getSelectedHtml(e.id,e.state.mType,e.text,e.state.headImg))),s&&s.length&&d&&l&&c)for(var h,o,u=0;u<s.length;u++)h=s[u],n.find('li[attrId="'+h+'"]').length||($curAnchor=$("#"+h+"_anchor"),r=$curAnchor.closest("li").attr("mType"),o=$curAnchor.text(),(a&&r&&"dept"!=r||!a)&&(i+=getSelectedHtml(h,$curAnchor.closest("li").attr("mType"),o,e.state.headImg)));l?n.append(i):t?i&&n.html(i):n.html("")}else{s=e.children_d;if("-1"==e.id)n.html("");else if(n.find('li[attrId="'+e.id+'"]').remove(),s&&s.length&&d&&l)for(u=0;u<s.length;u++)n.find('li[attrId="'+s[u]+'"]').remove()}}function getSelectedHtml(e,t,d,l){return l&&"null"!=l&&"undefined"!=l||(l="/img/user/"+t+".png"),'<li onclick="deleteOne($(this))" attrId="'+e+'" mType="'+t+'" headImg="'+l+'"><div class="jstree-default"><span><i class="jstree-icon jstree-themeicon"></i></span><span class="selected-name">'+d+'</span><span class="zmdi zmdi-tag-close"></span></div></li>'}$(document).ready((function(){var e=parent.layer.getFrameIndex(window.name);parent.$("#layui-layer-iframe"+e).height(parent.$("#layui-layer-iframe"+e).height()-40)}));