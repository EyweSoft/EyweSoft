function stepForward(e,t,s,n,a){var i="/instance/addOrEditInstance/"+e+"?objectType="+t+"&preId=&step="+s+"&isRunEdit="+a+"&parentname="+(n||window.name);parent.layer.closeAll(),openWindowLikeIframe({url:i,title:title,isParent:!0})}function selectPopup(e,t,s){var n=e.prev(),a="500px",i="520px";jQuery("body").height()<550&&(i="90%");var r="";"DEPT"==t?r=jQuery.i18n.prop("select.dept"):"USER"==t?r="选择用户":"ROLE_SYS"==t?r="选择系统角色":"ROLE_PJT"==t?r="选择项目角色":"ROLE_DPT"==t?r="选择部门角色":t.indexOf("GROUP_")>-1&&(a="830px",i="700px",r="选择分组字段"),showLoading(),top.layer.open({type:2,title:r,maxmin:!1,shadeClose:!0,resize:!0,scrollbar:!1,btn:"USER"==t?["确定","保存至常用联系人","取消"]:["确定","取消"],area:[a,i],content:["/search?type="+t+"&selectIds="+n.val()+"&isMul="+s,"no"],yes:function(s,a){var i=top.layer.getChildFrame("body",s),r="",l="",o="";if(t.indexOf("GROUP_")>-1?(r=i.find("#selectIds").val(),jQuery.ajax({url:"/field/getFieldNames",type:"post",data:{ids:r},async:!1,success:function(e){l=e}})):($li=i.find(".selected-ul li"),$li&&$li.length&&$li.each((function(){r?(r+=","+jQuery(this).attr("attrId"),l+=", "+jQuery(this).find(".selected-name").text()):(r=jQuery(this).attr("attrId"),l=jQuery(this).find(".selected-name").text()),"USER"==t&&(o+=getUserHtml(jQuery(this).attr("attrId"),jQuery(this).find(".selected-name").text(),jQuery(this).attr("mtype"),""))}))),"USER"==t){var c=e.closest(".field-content").find(".user-list");c.length?c.html(o):e.val(l)}else e.val(l);n.val(r),top.layer.close(s)},btn2:function(e,s){if("USER"==t){var n=s.find("iframe")[0].contentWindow;if("function"==typeof n.saveContactUser)return n.saveContactUser(),!1}else top.layer.close(e)},btn3:function(e,t){top.layer.close(e)},cancel:function(e,t){top.layer.close(e)}})}function getUserHtml(e,t,s,n){var a='<div class="cp" userId="'+e+'" onclick="viewUser(\''+e+'\')" title="'+t+'">';return a+='\t\t<i class="fa fa-minus-circle del" onclick="removeUser(jQuery(this))"></i>',a+='\t\t<div class="user-col">',a+=n?'\t\t\t<img src="'+n+'"/>':'\t\t\t<img src="/img/user/'+s+'.png"/>',a+=t,a+="\t\t</div>",a+="\t</div>"}function copyRskToPjt(e){e||(e=$("#selectIds").val()),e?(showLoading(),top.layer.open({type:2,title:"选择项目",maxmin:!1,shadeClose:!1,resize:!0,scrollbar:!1,hideBtn:!0,btn:[$.i18n.prop("common.comfirm"),$.i18n.prop("common.cancel")],area:["1000px","650px"],content:["/search?type=PJT&selectIds=&isMul=N","no"],yes:function(t,s){var n=top.layer.getChildFrame("body",t).find("#selectIds").val();e&&n?$.ajax({url:"/rsk/copyRskToPjt",type:"post",data:{rskLibIds:e,pjtId:n},success:function(e){0==e.code?(top.layer.close(t),parent.layer.msg(e.msg)):(top.layer.close(t),parent.layer.msg(e.msg,1))}}):alert("请先选择项目")},cancel:function(e,t){layer.close(e),hideLoading()}})):alert("请先选择风险")}