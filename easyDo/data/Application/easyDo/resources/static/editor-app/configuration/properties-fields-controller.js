var KisBpmFieldsCtrl=["$scope","$modal","$timeout","$translate",function(e,l,i,s){l({template:"editor-app/configuration/properties/fields-popup.html",scope:e})}],KisBpmFieldsPopupCtrl=["$scope","$q","$translate",function(e,l,i){if(void 0!==e.property.value&&null!==e.property.value&&void 0!==e.property.value.fields&&null!==e.property.value.fields){e.fields=angular.copy(e.property.value.fields);for(var s=0;s<e.fields.length;s++){var t=e.fields[s];void 0!==t.stringValue&&""!==t.stringValue?t.implementation=t.stringValue:void 0!==t.expression&&""!==t.expression?t.implementation=t.expression:void 0!==t.string&&""!==t.string&&(t.implementation=t.string)}}else e.fields=[];e.selectedFields=[],e.translationsRetrieved=!1,e.labels={};var n=i("PROPERTY.FIELDS.NAME"),d=i("PROPERTY.FIELDS.IMPLEMENTATION");l.all([n,d]).then((function(l){e.labels.nameLabel=l[0],e.labels.implementationLabel=l[1],e.translationsRetrieved=!0,e.gridOptions={data:"fields",enableRowReordering:!0,headerRowHeight:28,multiSelect:!1,keepLastSelected:!1,selectedItems:e.selectedFields,columnDefs:[{field:"name",displayName:e.labels.nameLabel},{field:"implementation",displayName:e.labels.implementationLabel}]}})),e.fieldDetailsChanged=function(){""!=e.selectedFields[0].stringValue?e.selectedFields[0].implementation=e.selectedFields[0].stringValue:""!=e.selectedFields[0].expression?e.selectedFields[0].implementation=e.selectedFields[0].expression:""!=e.selectedFields[0].string?e.selectedFields[0].implementation=e.selectedFields[0].string:e.selectedFields[0].implementation=""},e.addNewField=function(){e.fields.push({name:"fieldName",implementation:"",stringValue:"",expression:"",string:""})},e.removeField=function(){if(e.selectedFields.length>0){var l=e.fields.indexOf(e.selectedFields[0]);e.gridOptions.selectItem(l,!1),e.fields.splice(l,1),e.selectedFields.length=0,l<e.fields.length?e.gridOptions.selectItem(l+1,!0):e.fields.length>0&&e.gridOptions.selectItem(l-1,!0)}},e.moveFieldUp=function(){if(e.selectedFields.length>0){var l=e.fields.indexOf(e.selectedFields[0]);if(0!=l){var i=e.fields[l];e.fields.splice(l,1),$timeout((function(){e.fields.splice(l+-1,0,i)}),100)}}},e.moveFieldDown=function(){if(e.selectedFields.length>0){var l=e.fields.indexOf(e.selectedFields[0]);if(l!=e.fields.length-1){var i=e.fields[l];e.fields.splice(l,1),$timeout((function(){e.fields.splice(l+1,0,i)}),100)}}},e.save=function(){e.fields.length>0?(e.property.value={},e.property.value.fields=e.fields):e.property.value=null,e.updatePropertyInModel(e.property),e.close()},e.cancel=function(){e.close()},e.close=function(){e.property.mode="read",e.$hide()}}];