var KisBpmFormPropertiesCtrl=["$scope","$modal","$timeout","$translate",function(e,t,r,l){t({template:"editor-app/configuration/properties/form-properties-popup.html?version="+Date.now(),scope:e})}],KisBpmFormPropertiesPopupCtrl=["$scope","$q","$translate","$timeout",function(e,t,r,l){if(void 0!==e.property.value&&null!==e.property.value&&void 0!==e.property.value.formProperties&&null!==e.property.value.formProperties){e.formProperties=angular.copy(e.property.value.formProperties);for(var s=0;s<e.formProperties.length;s++){var o=e.formProperties[s];if(o.enumValues&&o.enumValues.length>0)for(var i=0;i<o.enumValues.length;i++){var n=o.enumValues[i];n.id||n.name||!n.value||(n.id=n.value,n.name=n.value)}}}else e.formProperties=[];e.selectedProperties=[],e.selectedEnumValues=[],e.translationsRetrieved=!1,e.labels={};var p=r("PROPERTY.FORMPROPERTIES.ID"),a=r("PROPERTY.FORMPROPERTIES.NAME"),u=r("PROPERTY.FORMPROPERTIES.TYPE");t.all([p,a,u]).then((function(t){e.labels.idLabel=t[0],e.labels.nameLabel=t[1],e.labels.typeLabel=t[2],e.translationsRetrieved=!0,e.gridOptions={data:"formProperties",enableRowReordering:!0,headerRowHeight:28,multiSelect:!1,keepLastSelected:!1,selectedItems:e.selectedProperties,columnDefs:[{field:"id",displayName:e.labels.idLabel},{field:"name",displayName:e.labels.nameLabel},{field:"type",displayName:e.labels.typeLabel}]},e.enumGridOptions={data:"selectedProperties[0].enumValues",enableRowReordering:!0,headerRowHeight:28,multiSelect:!1,keepLastSelected:!1,selectedItems:e.selectedEnumValues,columnDefs:[{field:"id",displayName:e.labels.idLabel},{field:"name",displayName:e.labels.nameLabel}]}})),e.propertyTypeChanged=function(){"date"===e.selectedProperties[0].type?e.selectedProperties[0].datePattern="MM-dd-yyyy hh:mm":delete e.selectedProperties[0].datePattern,"enum"===e.selectedProperties[0].type?e.selectedProperties[0].enumValues=[{id:"value1",name:"Value 1"},{id:"value2",name:"Value 2"}]:delete e.selectedProperties[0].enumValues};var d=1;e.addNewProperty=function(){e.formProperties.push({id:"new_property_"+d++,name:"",type:"string",readable:!0,writable:!0}),l((function(){e.gridOptions.selectItem(e.formProperties.length-1,!0)}))},e.removeProperty=function(){if(e.selectedProperties.length>0){var t=e.formProperties.indexOf(e.selectedProperties[0]);e.gridOptions.selectItem(t,!1),e.formProperties.splice(t,1),e.selectedProperties.length=0,t<e.formProperties.length?e.gridOptions.selectItem(t+1,!0):e.formProperties.length>0&&e.gridOptions.selectItem(t-1,!0)}},e.movePropertyUp=function(){if(e.selectedProperties.length>0){var t=e.formProperties.indexOf(e.selectedProperties[0]);if(0!=t){var r=e.formProperties[t];e.formProperties.splice(t,1),l((function(){e.formProperties.splice(t+-1,0,r)}),100)}}},e.movePropertyDown=function(){if(e.selectedProperties.length>0){var t=e.formProperties.indexOf(e.selectedProperties[0]);if(t!=e.formProperties.length-1){var r=e.formProperties[t];e.formProperties.splice(t,1),l((function(){e.formProperties.splice(t+1,0,r)}),100)}}},e.addNewEnumValue=function(){e.selectedProperties.length>0&&e.selectedProperties[0].enumValues.push({id:"",name:""}),l((function(){e.enumGridOptions.selectItem(e.selectedProperties[0].enumValues.length-1,!0)}))},e.removeEnumValue=function(){if(e.selectedProperties.length>0&&e.selectedEnumValues.length>0){var t=e.selectedProperties[0].enumValues.indexOf(e.selectedEnumValues[0]);e.enumGridOptions.selectItem(t,!1),e.selectedProperties[0].enumValues.splice(t,1),e.selectedEnumValues.length=0,t<e.selectedProperties[0].enumValues.length?l((function(){e.enumGridOptions.selectItem(t+1,!0)})):e.selectedProperties[0].enumValues.length>0&&l((function(){e.enumGridOptions.selectItem(t-1,!0)}))}},e.moveEnumValueUp=function(){if(e.selectedProperties.length>0&&e.selectedEnumValues.length>0){var t=e.selectedProperties[0].enumValues.indexOf(e.selectedEnumValues[0]);if(0!=t){var r=e.selectedProperties[0].enumValues[t];e.selectedProperties[0].enumValues.splice(t,1),l((function(){e.selectedProperties[0].enumValues.splice(t+-1,0,r)}))}}},e.moveEnumValueDown=function(){if(e.selectedProperties.length>0&&e.selectedEnumValues.length>0){var t=e.selectedProperties[0].enumValues.indexOf(e.selectedEnumValues[0]);if(t!=e.selectedProperties[0].enumValues.length-1){var r=e.selectedProperties[0].enumValues[t];e.selectedProperties[0].enumValues.splice(t,1),l((function(){e.selectedProperties[0].enumValues.splice(t+1,0,r)}))}}},e.save=function(){e.formProperties.length>0?(e.property.value={},e.property.value.formProperties=e.formProperties):e.property.value=null,e.updatePropertyInModel(e.property),e.close()},e.cancel=function(){e.$hide(),e.property.mode="read"},e.close=function(){e.$hide(),e.property.mode="read"}}];