var KisBpmEventListenersCtrl=["$scope","$modal","$timeout","$translate",function(e,t,s,n){t({template:"editor-app/configuration/properties/event-listeners-popup.html?version="+Date.now(),scope:e})}],KisBpmEventListenersPopupCtrl=["$scope","$q","$translate",function(e,t,s){void 0!==e.property.value&&null!==e.property.value&&void 0!==e.property.value.eventListeners&&null!==e.property.value.eventListeners?e.property.value.eventListeners.constructor==String?e.eventListeners=JSON.parse(e.property.value.eventListeners):e.eventListeners=angular.copy(e.property.value.eventListeners):e.eventListeners=[],e.selectedListeners=[],e.translationsRetrieved=!1,e.labels={};var n=s("PROPERTY.EXECUTIONLISTENERS.EVENT"),r=s("PROPERTY.EXECUTIONLISTENERS.FIELDS.IMPLEMENTATION"),i=s("PROPERTY.EXECUTIONLISTENERS.FIELDS.NAME");t.all([n,r,i]).then((function(t){e.labels.eventLabel=t[0],e.labels.implementationLabel=t[1],e.labels.nameLabel=t[2],e.translationsRetrieved=!0,e.gridOptions={data:"eventListeners",enableRowReordering:!0,headerRowHeight:28,multiSelect:!1,keepLastSelected:!1,selectedItems:e.selectedListeners,afterSelectionChange:function(t,s){if(e.selectedListeners.length>0){var n=e.selectedListeners[0].fields;if(null!=n)for(var r=0;r<n.length;r++){var i=n[r];void 0!==i.stringValue&&""!==i.stringValue?i.implementation=i.stringValue:void 0!==i.expression&&""!==i.expression?i.implementation=i.expression:void 0!==i.string&&""!==i.string&&(i.implementation=i.string)}e.selectedListeners[0].events&&0!=e.selectedListeners[0].events.length||(e.selectedListeners[0].events=[{event:""}])}},columnDefs:[{field:"event",displayName:e.labels.eventLabel},{field:"implementation",displayName:e.labels.implementationLabel}]}})),e.addEventValue=function(t){e.selectedListeners[0].events.splice(t+1,0,{event:""})},e.removeEventValue=function(t){e.selectedListeners[0].events.splice(t,1),e.listenerDetailsChanged()},e.listenerDetailsChanged=function(){var t=e.selectedListeners[0];if(t.events){for(var s="",n=0;n<t.events.length;n++)n>0&&(s+=", "),s+=t.events[n].event;e.selectedListeners[0].event=s}if(t.rethrowEvent){var r="";t.rethrowType&&t.rethrowType.length>0&&("error"===t.rethrowType&&""!==t.errorcode?r="Rethrow as error "+t.errorcode:"message"===t.rethrowType&&""!==t.messagename?r="Rethrow as message "+t.messagename:"signal"!==t.rethrowType&&"globalSignal"!==t.rethrowType||""===t.signalname||(r="Rethrow as signal "+t.signalname)),e.selectedListeners[0].implementation=r}else""!==e.selectedListeners[0].className?e.selectedListeners[0].implementation=e.selectedListeners[0].className:""!==e.selectedListeners[0].delegateExpression?e.selectedListeners[0].implementation=e.selectedListeners[0].delegateExpression:e.selectedListeners[0].implementation=""},e.addNewListener=function(){e.eventListeners.push({event:"",implementation:"",className:"",delegateExpression:"",retrowEvent:!1})},e.removeListener=function(){if(e.selectedListeners.length>0){var t=e.eventListeners.indexOf(e.selectedListeners[0]);e.gridOptions.selectItem(t,!1),e.eventListeners.splice(t,1),e.selectedListeners.length=0,t<e.eventListeners.length?e.gridOptions.selectItem(t+1,!0):e.eventListeners.length>0&&e.gridOptions.selectItem(t-1,!0)}},e.moveListenerUp=function(){if(e.selectedListeners.length>0){var t=e.eventListeners.indexOf(e.selectedListeners[0]);if(0!=t){var s=e.eventListeners[t];e.eventListeners.splice(t,1),$timeout((function(){e.eventListeners.splice(t+-1,0,s)}),100)}}},e.moveListenerDown=function(){if(e.selectedListeners.length>0){var t=e.eventListeners.indexOf(e.selectedListeners[0]);if(t!=e.eventListeners.length-1){var s=e.eventListeners[t];e.eventListeners.splice(t,1),$timeout((function(){e.eventListeners.splice(t+1,0,s)}),100)}}},e.save=function(){e.eventListeners.length>0?(e.property.value={},e.property.value.eventListeners=e.eventListeners):e.property.value=null,e.updatePropertyInModel(e.property),e.close()},e.cancel=function(){e.property.mode="read",e.$hide()},e.close=function(){e.property.mode="read",e.$hide()}}];